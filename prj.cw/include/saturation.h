//
// Created by Константин Гончаров on 20.03.2025.
//

/**
 * @file saturation.h
 * @brief Функции для вычисления карты насыщенности и метрик.
 *
 * Данный модуль содержит функции для вычисления карты насыщенности
 * (определяемой как евклидово расстояние от пикселя до линии R=G=B),
 * визуализации этой карты и вычисления среднеквадратичной ошибки (MSE)
 * для заданных масок.
 */

#ifndef SATURATION_H
#define SATURATION_H

#include <opencv2/opencv.hpp>

/**
 * @brief Вычисляет карту насыщенности для каждого пикселя.
 *
 * Насыщенность определяется как стандартное отклонение значений каналов от их среднего.
 *
 * @param img Изображение в формате CV_32FC3.
 * @return Карта насыщенности в формате CV_32FC1.
 */
cv::Mat computeSaturationMap(const cv::Mat &img);

/**
 * @brief Визуализирует карту насыщенности, нормализуя значения в диапазон [0,255].
 *
 * @param satMap Входная карта насыщенности (CV_32FC1).
 * @return Изображение в градациях серого (CV_8U).
 */
cv::Mat visualizeSaturation(const cv::Mat &satMap);

/**
 * @brief Вычисляет среднеквадратичную ошибку (MSE) для значений насыщенности по заданной маске.
 *
 * @param saturation Карта насыщенности (CV_32FC1).
 * @param mask Бинарная маска (CV_8UC1), где 255 – пиксели, входящие в область.
 * @return Значение MSE.
 */
double computeMSE(const cv::Mat &saturation, const cv::Mat &mask);

#endif // SATURATION_H

